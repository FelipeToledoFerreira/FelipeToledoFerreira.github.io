"0","#| fig-cap: ""Left panel: raw absorbance curves. Right panel: smoothed absorbance curves."""
"0","tecator_data = tecator_data |> mutate(absorbance_basis = tfb(absorbance,"
"0","                                                             basis = ""spline"","
"0","                                                             bs = ""bs"","
"0","                                                             k = 15,"
"0","                                                             verbose = FALSE),"
"0","                                      dabsorbance_basis = tfb(dabsorbance,"
"0","                                                              basis = ""spline"","
"0","                                                              bs = ""bs"","
"0","                                                              k = 30,"
"0","                                                              verbose = FALSE))"
"0","g13 = tecator_data |>"
"0","  ggplot(mapping = aes(y = absorbance_basis,"
"0","                       color = fat20)) +"
"0","  geom_spaghetti() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       y = substitute(""Smoothed Absorbance""),"
"0","       col = """") +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 930, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""930"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(845, 1055)) +"
"0","  scale_color_manual(values = c(""green"", ""orange"")) +"
"0","  geom_vline(xintercept = 930,"
"0","             linetype = ""dashed"","
"0","             col = ""black"","
"0","             alpha = .5)"
"0","grid.arrange(g03,"
"0","             g13,"
"0","             ncol = 2)"
