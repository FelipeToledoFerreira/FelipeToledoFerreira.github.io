"0","#| fig-cap: ""Left panel: absorbance variance curves, separated by fat percentage. Right panel: correlogram of the absorbance curves."""
"0","g05 = tecator_data |> "
"0","  group_by(fat20) |> summarise(var_absorbance = var(absorbance)) |>"
"0","  mutate(fat20 = factor(fat20,"
"0","                        levels = c(""20% < Fat"","
"0","                                   ""20% > Fat"","
"0","                                   ""Overall""))) |>"
"0","  add_row(fat20 = ""Overall"","
"0","          var_absorbance = var(tecator_data$absorbance)) |>"
"0","  ggplot(mapping = aes(y = var_absorbance,"
"0","                       color = factor(fat20,"
"0","                                      levels = c(""20% > Fat"","
"0","                                                 ""20% < Fat"","
"0","                                                 ""Overall"")))) +"
"0","  geom_spaghetti() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       y = substitute(""Absorbance""^2),"
"0","       col = """") +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 930, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""930"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(845, 1055)) +"
"0","  scale_color_manual(values = c(""green"", ""orange"", ""red"")) +"
"0","  geom_vline(xintercept = 930,"
"0","             linetype = ""dashed"","
"0","             col = ""black"","
"0","             alpha = .5)"
"0","g06 = melt(data = cor(tecator$absorp.fdata$data)) |>"
"0","  mutate(x = 850 + 200 * (Var1 - 1) / 99,"
"0","         y = 850 + 200 * (Var2 - 1) / 99,"
"0","         z = value,"
"0","         Var1 = NULL,"
"0","         Var2 = NULL,"
"0","         value = NULL) |>"
"0","  ggplot(mapping = aes(x = x,"
"0","                       y = y,"
"0","                       fill = z)) +"
"0","  geom_raster() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 size = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  size = .125),"
"0","        legend.position = ""top"","
"0","        plot.margin = unit(c(.25, .75, .25, .75), ""cm"")) +"
"0","  labs(x = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       y = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       fill = ""Correlation"") +"
"0","  scale_y_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(850, 1050)) +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(850, 1050)) +"
"0","  scale_fill_continuous(type = ""viridis"")"
"0","grid.arrange(g05,"
"0","             g06,"
"0","             ncol = 2)"
