"0","#| fig-cap: ""Left panel: spaghetti plot of the absorbance curves, separated by fat percentage. Right panel: mean absorbance curves, separated by fat percentage."""
"0","g03 = tecator_data |>"
"0","  ggplot(mapping = aes(y = absorbance,"
"0","                       color = fat20)) +"
"0","  geom_spaghetti() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       y = ""Absorbance"","
"0","       col = """") +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 930, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""930"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(845, 1055)) +"
"0","  scale_color_manual(values = c(""green"", ""orange"")) +"
"0","  geom_vline(xintercept = 930,"
"0","             linetype = ""dashed"","
"0","             col = ""black"","
"0","             alpha = .5)"
"0","g04 = tecator_data |> "
"0","  group_by(fat20) |> summarise(mean_absorbance = mean(absorbance)) |>"
"0","  mutate(fat20 = factor(fat20,"
"0","                        levels = c(""20% > Fat"","
"0","                                   ""20% < Fat"","
"0","                                   ""Overall""))) |>"
"0","  add_row(fat20 = ""Overall"","
"0","          mean_absorbance = mean(tecator_data$absorbance)) |>"
"0","  ggplot(mapping = aes(y = mean_absorbance,"
"0","                       color = factor(fat20,"
"0","                                      levels = c(""20% > Fat"","
"0","                                                 ""20% < Fat"","
"0","                                                 ""Overall"")))) +"
"0","  geom_spaghetti() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = expression(paste(""Wavelength "", ""(in "", italic(""nm""), "")"")),"
"0","       y = ""Absorbance"","
"0","       col = """") +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(850, 900, 930, 950, 1000, 1050),"
"0","                     labels = c(""850"", ""900"", ""930"", ""950"", ""1000"", ""1050""),"
"0","                     limits = c(845, 1055)) +"
"0","  scale_color_manual(values = c(""green"", ""orange"", ""red"")) +"
"0","  geom_vline(xintercept = 930,"
"0","             linetype = ""dashed"","
"0","             col = ""black"","
"0","             alpha = .5)"
"0","grid.arrange(g03,"
"0","             g04,"
"0","             ncol = 2)"
