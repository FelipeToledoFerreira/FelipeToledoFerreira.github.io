"0","tecator_data$dabsorbance_matrix = tecator_data$dabsorbance |> as.matrix()"
"0","tecator_data = tecator_data |> mutate(fat = fat / 100)"
"0","fit_underfit = fgam(formula = fat ~ af(X = dabsorbance_matrix,"
"0","                                       bs = ""tp"","
"0","                                       k = 4,"
"0","                                       m = 3),"
"0","           fitter = ""gam"","
"0","           family = betar(link = ""probit""),"
"0","           tensortype = ""te"","
"0","           data = tecator_data,"
"0","           weights = tecator_data$train,"
"0","           method = ""REML"")"
"0","fit_overfit = fgam(formula = fat ~ af(X = dabsorbance_matrix,"
"0","                                      bs = ""tp"","
"0","                                      k = 5,"
"0","                                      m = 3),"
"0","                   fitter = ""gam"","
"0","                   family = betar(link = ""probit""),"
"0","                   tensortype = ""te"","
"0","                   data = tecator_data,"
"0","                   weights = tecator_data$train,"
"0","                   method = ""REML"")"
"0","fit_ideal = fgam(formula = fat ~ af(X = dabsorbance_matrix,"
"0","                                    bs = ""tp"","
"0","                                    k = 6,"
"0","                                    m = 3),"
"0","                 fitter = ""gam"","
"0","                 family = betar(link = ""probit""),"
"0","                 tensortype = ""te"","
"0","                 data = tecator_data,"
"0","                 weights = tecator_data$train,"
"0","                 method = ""REML"")"
"0",""
"0","tecator_data = tecator_data |>"
"0","  mutate(fat_under = fit_underfit$fitted.values,"
"0","         fat_over = fit_overfit$fitted.values,"
"0","         fat_ideal = fit_ideal$fitted.values)"
"0",""
"0","g17 = tecator_data |>"
"0","  mutate(train = factor(x = ifelse(test = tecator_data$train == 1, ""Train"", ""Test""),"
"0","                        levels = c(""Train"", ""Test""))) |>"
"0","  ggplot(mapping = aes(x = fat_under,"
"0","                       y = fat,"
"0","                       color = train)) +"
"0","  geom_point() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = ""Fitted"","
"0","       y = ""True"","
"0","       col = """") +"
"0","  scale_color_manual(values = c(""blue"", ""red"")) +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  scale_y_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  geom_abline(slope = 1,"
"0","              intercept = 0,"
"0","              linetype = ""dashed"")"
"0","g18 = tecator_data |>"
"0","  mutate(train = factor(x = ifelse(test = tecator_data$train == 1, ""Train"", ""Test""),"
"0","                        levels = c(""Train"", ""Test""))) |>"
"0","  ggplot(mapping = aes(x = fat_over,"
"0","                       y = fat,"
"0","                       color = train)) +"
"0","  geom_point() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = ""Fitted"","
"0","       y = ""True"","
"0","       col = """") +"
"0","  scale_color_manual(values = c(""blue"", ""red"")) +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  scale_y_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  geom_abline(slope = 1,"
"0","              intercept = 0,"
"0","              linetype = ""dashed"")"
"0","g19 = tecator_data |>"
"0","  mutate(train = factor(x = ifelse(test = tecator_data$train == 1, ""Train"", ""Test""),"
"0","                        levels = c(""Train"", ""Test""))) |>"
"0","  ggplot(mapping = aes(x = fat_ideal,"
"0","                       y = fat,"
"0","                       color = train)) +"
"0","  geom_point() +"
"0","  theme_classic() +"
"0","  theme(text = element_text(size = unit(11, ""pt""),"
"0","                            family = ""LM Roman 10"","
"0","                            color = ""black""),"
"0","        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, ""cm""), "
"0","                                                     ends = ""last"","
"0","                                                     angle = 30,"
"0","                                                     type = ""closed""),"
"0","                                 linewidth = .25),"
"0","        axis.ticks = element_line(color = ""black"","
"0","                                  linewidth = .125),"
"0","        legend.position = ""top"") +"
"0","  labs(x = ""Fitted"","
"0","       y = ""True"","
"0","       col = """") +"
"0","  scale_color_manual(values = c(""blue"", ""red"")) +"
"0","  scale_x_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  scale_y_continuous(expand = c(0, 0),"
"0","                     breaks = c(0, .5, 1),"
"0","                     labels = c(""0"", ""1/2"", ""1""),"
"0","                     limits = c(0, 1)) +"
"0","  geom_abline(slope = 1,"
"0","              intercept = 0,"
"0","              linetype = ""dashed"")"
"0","grid.arrange(g17,"
"0","             g18,"
"0","             g19,"
"0","             ncol = 3)"
