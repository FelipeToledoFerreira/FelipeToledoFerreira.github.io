{
  "hash": "b7b83e1f8c7103efb72ac235c22219e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tecator Infratec Analyzer\"\nsubtitle: '...a Vignette on Functional Data Analysis<br><img id=\"logoDoIME\" src=\"FDA logo.png\" width=40% style=\"float: center; vertical-align: middle; margin: 0px 350px 0px;\">'\nauthor: \"[Felipe Toledo Ferreira](https://github.com/FelipeToledoFerreira)\"\ndate: today\nbibliography: vignette0001.bib\ncsl: proceedings-of-the-royal-society-b.csl\nnocite: |\n  @ferraty:2006, @scheipl:2023, @bande:2012, @wood:2011, @wood:2016, @wood:2004, @wood:2017, @wood:2003, @mcLean:2014, @goldsmith:2024\n---\n\n\n\n\n\n# Introduction\n\n## Data\n\nThe Tecator Infratec Feed Analyzer data set (seen in @ferraty:2006), is composed of data recorded on a Tecator Infratec Food and Feed Analyzer tool, working in the wavelength range 850 - 1050<i>nm</i> by the Near Infrared Transmission (NIT) principle. Each sample ($N = 215$) contains finely chopped pure meat with different moisture, fat and protein contents. For each meat sample the data consists of a 100 channel spectrum of absorbances and the contents of moisture (water), fat and protein. The absorbance is $-\\log_{10}$ of the transmittance measured by the spectrometer. The three contents, measured in percent, are determined by analytic chemistry (click [here](https://lib.stat.cmu.edu/datasets/tecator) for further details).\n\n## Setup\n\nThis vignette is primarily concerned with presenting a set of methods to perform functional regression, motivated by the Tecator Infratec Feed Analyzer dataset, and with computational tools provided by the <tt>R</tt> programming language. First, a number of packages must be downloaded and subsequently called. In particular, the '[<tt>tidyfun</tt>](https://tidyfun.github.io/tidyfun/)' package must be downloaded remotely, as it is not yet available on <tt>CRAN</tt>. The following chunk performs this step:\n\n\n\n::: {.cell}\n\n```{.r .funky .cell-code}\nlibrary(\"fda.usc\")    ## R package containing the 'tecator' dataset\n#> Warning: pacote 'mgcv' foi compilado no R versão 4.4.3\nlibrary(\"tidyverse\")  ## R package for tidy data manipulation and visualization\n#> Warning: pacote 'ggplot2' foi compilado no R versão 4.4.3\nlibrary(\"tf\")         ## R package for tidy functional data manipulation\nlibrary(\"tidyfun\")    ## R package for tidy functional data visualization\nlibrary(\"extrafont\")\nlibrary(\"gridExtra\")  ## R package for additional visualization tools\nlibrary(\"moments\")\nlibrary(\"corrplot\")\nlibrary(\"reshape2\")\nlibrary(\"refund\")\n#> Warning: pacote 'refund' foi compilado no R versão 4.4.3\nlibrary(\"forcats\")\n```\n:::\n\n\n\nThe '<tt>tecator</tt>' dataset is sourced from the <tt>fda.usc</tt> package (see @bande:2012). Noticeably, it is stored therein as a <tt>list</tt> object - this vignette converts this dataset to a <tt>data.frame</tt> object, via the tools made available on the <tt>tf</tt> package, which seeks to provide classes and methods for \"Tidy Functional Data\", inspired by the greater existing <tt>tidyverse</tt> packages for data manipulation and visualization. The following chunk performs this conversion:\n\n\n\n::: {.cell}\n\n```{.r .funky .cell-code}\n## Importing the 'tecator' dataset\ndata(tecator)\n## Converting 'tecator' to df (data frame)\ntecator_data = data.frame(fat = tecator$y$Fat,\n                          water = tecator$y$Water,\n                          protein = tecator$y$Protein)\n## Adding the functional data, in tfd structure, to the df object\ntecator_data = tecator_data |>\n  mutate(absorbance = tfd(data = tecator$absorp.fdata$data,\n                          arg = tecator$absorp.fdata$argvals))\n## Separating data by fat percentage\ntecator_data = tecator_data |>\n  mutate(fat20 = factor(ifelse(test = (fat >= 20),\n                               yes = \"20% > Fat\",\n                               no = \"20% < Fat\"),\n                        levels = c(\"20% > Fat\",\n                                   \"20% < Fat\")))\n```\n:::\n\n\n\n@tbl-table0001 illustrates how functional data is stored within a <tt>data.frame</tt> object through the implementation of the <tt>tf</tt> package - in particular, the <tt>absorbance</tt> column is stored as a <tt>tfd</tt> object, such that, to every row within the resulting data frame, there exists a corresponding functional observation.\n\n\n\n::: {#tbl-table0001 .cell tbl-cap='Snapshot of the five first rows of the \\'<tt>tecator</tt>\\' dataset. Note that the column labelled as \\'<tt>absorbance</tt>\\' is composed of \\'<tt>tfd</tt>\\' objects, from the \\'<tt>tidyfun</tt>\\' <tt>R</tt> package.'}\n\n|  fat| water| protein|           absorbance            |fat20     |\n|----:|-----:|-------:|:-------------------------------:|:---------|\n| 22.5|  60.5|    16.7| 1: (850,3);(852,3);(854,3); ... |20% > Fat |\n| 40.1|  46.0|    13.5| 2: (850,3);(852,3);(854,3); ... |20% > Fat |\n|  8.4|  71.0|    20.5| 3: (850,3);(852,3);(854,3); ... |20% < Fat |\n|  5.9|  72.8|    20.7| 4: (850,3);(852,3);(854,3); ... |20% < Fat |\n| 25.5|  58.3|    15.5| 5: (850,3);(852,3);(854,3); ... |20% > Fat |\n:::\n\n\n\n------------------------------------------------------------------------\n\n# Exploratory Data Analysis\n\n## Fat percentage\n\nExpressly, the main goal of this application is to construct a predictive model for the fat percentage of the meat samples, utilizing corresponding absorbance curves as model covariates. For that purpose, first a simple exploratory analysis of the data must be performed, to allow for model elicitation. @fig-figures0001 and @tbl-table0002 seen below provide a brief view of the distribution of the fat percentage. Hereafter, the observed values of fat percentage in the dataset may also be referred to as $y_1,\\ldots,y_{215}$, which is assumed to be sampled from a set of independent random variables $Y_1,\\ldots,Y_{215}$ with unknown distribution.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\nknitr::kable(head(tecator_data, 5), align = 'rrrcl')\n```\n\n::: {#fig-figures0001-1 .cell-output-display}\n\n\n|  fat| water| protein|           absorbance            |fat20     |\n|----:|-----:|-------:|:-------------------------------:|:---------|\n| 22.5|  60.5|    16.7| 1: (850,3);(852,3);(854,3); ... |20% > Fat |\n| 40.1|  46.0|    13.5| 2: (850,3);(852,3);(854,3); ... |20% > Fat |\n|  8.4|  71.0|    20.5| 3: (850,3);(852,3);(854,3); ... |20% < Fat |\n|  5.9|  72.8|    20.7| 4: (850,3);(852,3);(854,3); ... |20% < Fat |\n| 25.5|  58.3|    15.5| 5: (850,3);(852,3);(854,3); ... |20% > Fat |\n\n\n\nLeft panel: sample estimated density of the fat percentage. Right panel: sample boxplot of the fat percentage.\n:::\n\n```{.r .funky .cell-code}\ng01 = tecator$y |> ggplot(mapping = aes(x = Fat)) +\n  geom_density(fill = \"cyan\",\n               alpha = .25,\n               linetype = \"dashed\") +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 size = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  size = .125)) +\n  labs(x = \"Fat %\",\n       y = \"Density\") +\n  scale_y_continuous(expand = c(0, 0),\n                     breaks = c(0, 0.01, 0.02, 0.03, 0.04, 0.05),\n                     labels = c(\"0\", substitute(\"1/100\"), substitute(\"2/50\"), substitute(\"3/100\"), substitute(\"1/25\"), substitute(\"1/20\")),\n                     limits = c(0, 0.05)) +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(5, 15, 25, 35, 45),\n                     labels = c(\"5\", \"15\", \"25\", \"35\", \"45\"),\n                     limits = c(0.9, 49.1))\n#> Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.\n#> ℹ Please use the `linewidth` argument instead.\n\ng02 = tecator$y |> ggplot(mapping = aes(x = Fat)) +\n  geom_boxplot(fill = \"magenta\",\n               alpha = .5) +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 size = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  size = .125),\n        axis.text.y = element_blank(),\n        axis.title.y = element_blank(),\n        axis.minor.ticks.y.left = element_blank()) +\n  labs(x = \"Fat %\",\n       y = \"Density\")\n\ngrid.arrange(g01,\n             g02,\n             widths = c(1, 1),\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: sample estimated density of the fat percentage. Right panel: sample boxplot of the fat percentage.](vignette0001_files/figure-html/fig-figures0001-1.png){#fig-figures0001-2 fig-align='center' width=768}\n:::\n:::\n\n::: {#tbl-table0002 .cell tbl-cap='Sample summary statistics of the fat percentage.'}\n\n| Min.| 1st Qu.| Median|   Mean| 3rd Qu.| Max.|\n|----:|-------:|------:|------:|-------:|----:|\n|  0.9|     7.3|     14| 18.142|      28| 49.1|\n:::\n\n\n\nAdditionally, the sample skewness and kurtosis were computed as $\\widehat{\\text{Skew}}(Y) \\approx 0.802$ and $\\widehat{\\text{Kurt}}(Y) \\approx 2.573$. As the data refers to a percentage value, its support is bounded on the interval $[0,100]$, which may be normalized to the unit interval $[0,1]$ for computatibility purposes. As none of the observed values are at the boundaries $0$ or $1$ (and it is reasonable to assume that no observation will attain this value), the fat percentage may likewise be assumed to belong to the strictly closed $(0,100)$ interval. Generalized linear models may consequently be more appropriate to model this form of data, in particular for families with bounded support (e.g.: Beta regression).\n\n## Absorbance curves\n\nThe absorbance curve data, unlike the fat percentage data seen in the previous subsections, is composed of values obtainted discreetly by subjecting each of the meat samples to a spectrometric measuring device varying in the 850 - 1050<i>nm</i> wavelength range uniformly, with $100$ equal design points across all meat samples. This results in $100 \\cdot 215 = 21500$ observations in total. @fig-figures0002 and @fig-figures0003 provide a brief analysis on the distribution of the data; the plotted data is composed of the raw (i.e.: not smoothed) data. As [previous reports](http://eio.usc.es/eipc1/BASE/BASEMASTER/FORMULARIOS-PHP-DPTO/REPORTS/report11_02.pdf) have indicated the presence of an additional peak on the absorbance curves around the 930<i>nm</i> wavelength for meat samples with fat percentage superceding 20, the data are separated amongst these two groups.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ng03 = tecator_data |>\n  ggplot(mapping = aes(y = absorbance,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = \"Absorbance\",\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\")) +\n  geom_vline(xintercept = 930,\n             linetype = \"dashed\",\n             col = \"black\",\n             alpha = .5)\ng04 = tecator_data |> \n  group_by(fat20) |> summarise(mean_absorbance = mean(absorbance)) |>\n  mutate(fat20 = factor(fat20,\n                        levels = c(\"20% > Fat\",\n                                   \"20% < Fat\",\n                                   \"Overall\"))) |>\n  add_row(fat20 = \"Overall\",\n          mean_absorbance = mean(tecator_data$absorbance)) |>\n  ggplot(mapping = aes(y = mean_absorbance,\n                       color = factor(fat20,\n                                      levels = c(\"20% > Fat\",\n                                                 \"20% < Fat\",\n                                                 \"Overall\")))) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = \"Absorbance\",\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\", \"red\")) +\n  geom_vline(xintercept = 930,\n             linetype = \"dashed\",\n             col = \"black\",\n             alpha = .5)\ngrid.arrange(g03,\n             g04,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: spaghetti plot of the absorbance curves, separated by fat percentage. Right panel: mean absorbance curves, separated by fat percentage.](vignette0001_files/figure-html/fig-figures0002-1.png){#fig-figures0002 fig-align='center' width=768}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ng05 = tecator_data |> \n  group_by(fat20) |> summarise(var_absorbance = var(absorbance)) |>\n  mutate(fat20 = factor(fat20,\n                        levels = c(\"20% < Fat\",\n                                   \"20% > Fat\",\n                                   \"Overall\"))) |>\n  add_row(fat20 = \"Overall\",\n          var_absorbance = var(tecator_data$absorbance)) |>\n  ggplot(mapping = aes(y = var_absorbance,\n                       color = factor(fat20,\n                                      levels = c(\"20% > Fat\",\n                                                 \"20% < Fat\",\n                                                 \"Overall\")))) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(\"Absorbance\"^2),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\", \"red\")) +\n  geom_vline(xintercept = 930,\n             linetype = \"dashed\",\n             col = \"black\",\n             alpha = .5)\ng06 = melt(data = cor(tecator$absorp.fdata$data)) |>\n  mutate(x = 850 + 200 * (Var1 - 1) / 99,\n         y = 850 + 200 * (Var2 - 1) / 99,\n         z = value,\n         Var1 = NULL,\n         Var2 = NULL,\n         value = NULL) |>\n  ggplot(mapping = aes(x = x,\n                       y = y,\n                       fill = z)) +\n  geom_raster() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 size = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  size = .125),\n        legend.position = \"top\",\n        plot.margin = unit(c(.25, .75, .25, .75), \"cm\")) +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       fill = \"Correlation\") +\n  scale_y_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"950\", \"1000\", \"1050\"),\n                     limits = c(850, 1050)) +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"950\", \"1000\", \"1050\"),\n                     limits = c(850, 1050)) +\n  scale_fill_continuous(type = \"viridis\")\ngrid.arrange(g05,\n             g06,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: absorbance variance curves, separated by fat percentage. Right panel: correlogram of the absorbance curves.](vignette0001_files/figure-html/fig-figures0003-1.png){#fig-figures0003 fig-align='center' width=768}\n:::\n:::\n\n\n\nFrom a modelling standpoint, the values obtained at each design point may be considered covariates $x_{i,1},\\ldots,x_{i,100}$, for $i \\in \\{1,\\ldots,215\\}$, and as $100 = p < N = 215$, even a simple linear regression model is feasible. However, as evidenced in the Right panel of Figure \\@ref(fig:figures0003), the data is highly correlated. Note that the minimum absolute correlation observed across the absorbance curves was $\\min_{i,j}\\{\\vert \\rho_{i,j} \\vert\\} \\approx 0.963$. This implies that, were the data applied indiscriminately in a simpler linear regression model, it would be subject to a significant amount of multicollinearity. Alternatively, each absorbance curve may be considered a functional covariate $\\chi_{1},\\ldots,\\chi_{215}$, which may be estimated by smoothing the discrete observed values, allowing for a more flexible form of high-dimensional modelling through <i>functional regression</i>. Adopting the purview of functional data analysis in this context also presents other advantages: functionals (i.e.: derivatives, integrals, etc.) of the data in question may likewise be explored. It is important to remark that the values of these functionals is dependent on the support of the data in question. The method '<tt>tf_derive()</tt>', part of the '<tt>tf</tt>' '<tt>R</tt>' package, allows for the computation of the first-order derivative of the absorbance curves. Table @tbl-table0003 provides a view of the inclusion of the derivative column.\n\n\n\n::: {#tbl-table0003 .cell tbl-cap='Comparisons of the \\'<tt>absorbance</tt>\\' and \\'<tt>dabsorbance</tt>\\' columns of the five first rows of the \\'<tt>tecator</tt>\\' dataset. The column labelled as \\'<tt>dabsorbance</tt>\\' is composed of \\'<tt>tfd</tt>\\' objects, and represents the first order derivative of the \\'<tt>absorbance</tt>\\' column, as computed via finite differences.'}\n\n| fat  |           absorbance            |                 dabsorbance                 |\n|:----:|:-------------------------------:|:-------------------------------------------:|\n| 22.5 | 1: (850,3);(852,3);(854,3); ... | 1: (851,2e-04);(853,2e-04);(855,3e-04); ... |\n| 40.1 | 2: (850,3);(852,3);(854,3); ... | 2: (851,0.002);(853,0.002);(855,0.002); ... |\n| 8.4  | 3: (850,3);(852,3);(854,3); ... | 3: (851,9e-04);(853,8e-04);(855,9e-04); ... |\n| 5.9  | 4: (850,3);(852,3);(854,3); ... | 4: (851,9e-04);(853,8e-04);(855,9e-04); ... |\n| 25.5 | 5: (850,3);(852,3);(854,3); ... | 5: (851,9e-04);(853,9e-04);(855,9e-04); ... |\n:::\n\n\n\nAs similarly seen in previous reports, the derivative of the absorbance curves is significantly different for meat samples with fat percentage greater than 20%, as illustrated by @fig-figures0004 and @fig-figures0005. Unlike the usual absorbance curves, in this context the minimum absolute correlation observed across the derivatives of the absorbance curves is $\\min_{i,j}\\{\\vert \\tilde{\\rho}_{i,j} \\vert\\} \\approx 0$. The $D$ symbol is adopted to denote the application of the derivative. Note, in the Right panel of @fig-figures0005, that the correlogram presents a steep decrease in correlation between the 930<i>nm</i> and 950<i>nm</i> wavelengths. This corresponds to a steep valley in the mean function for the data with fat percentage greater than 20, as seen in the Right panel of @fig-figures0004.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ng07 = tecator_data |>\n  ggplot(mapping = aes(y = dabsorbance,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(paste(italic(\"D\"), \"Absorbance\")),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\"))\ng08 = tecator_data |> \n  group_by(fat20) |> summarise(mean_dabsorbance = mean(dabsorbance)) |>\n  mutate(fat20 = factor(fat20,\n                        levels = c(\"20% < Fat\",\n                                   \"20% > Fat\",\n                                   \"Overall\"))) |>\n  add_row(fat20 = \"Overall\",\n          mean_dabsorbance = mean(tecator_data$dabsorbance)) |>\n  ggplot(mapping = aes(y = mean_dabsorbance,\n                       color = factor(fat20,\n                                      levels = c(\"20% > Fat\",\n                                                 \"20% < Fat\",\n                                                 \"Overall\")))) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(paste(italic(\"D\"), \"Absorbance\")),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\", \"red\"))\ngrid.arrange(g07,\n             g08,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: spaghetti plot of the derivative of the absorbance curves, separated by fat percentage. Right panel: mean derivative of the absorbance curves, separated by fat percentage.](vignette0001_files/figure-html/fig-figures0004-1.png){#fig-figures0004 fig-align='center' width=768}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ng09 = tecator_data |> \n  group_by(fat20) |> summarise(var_dabsorbance = var(dabsorbance)) |>\n  mutate(fat20 = factor(fat20,\n                        levels = c(\"20% < Fat\",\n                                   \"20% > Fat\",\n                                   \"Overall\"))) |>\n  add_row(fat20 = \"Overall\",\n          var_dabsorbance = var(tecator_data$dabsorbance)) |>\n  ggplot(mapping = aes(y = var_dabsorbance,\n                       color = factor(fat20,\n                                      levels = c(\"20% > Fat\",\n                                                 \"20% < Fat\",\n                                                 \"Overall\")))) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(paste(\"(\", italic(\"D\"), \"Absorbance)\"^2)),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\", \"red\"))\ng10 = tecator_data$dabsorbance |>\n  as.matrix() |>\n  cor() |>\n  melt() |>\n  mutate(x = Var1,\n         y = Var2,\n         z = value,\n         Var1 = NULL,\n         Var2 = NULL,\n         value = NULL) |>\n  ggplot(mapping = aes(x = x,\n                       y = y,\n                       fill = z)) +\n  geom_raster() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 size = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  size = .125),\n        legend.position = \"top\",\n        plot.margin = unit(c(.25, .75, .25, .75), \"cm\")) +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       fill = \"Correlation\") +\n  scale_y_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(850, 1050)) +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(850, 1050)) +\n  scale_fill_continuous(type = \"viridis\")\ngrid.arrange(g09,\n             g10,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: variance of the derivative of the absorbance curves, separated by fat percentage. Right panel: correlogram of the derivative of the absorbance curves.](vignette0001_files/figure-html/fig-figures0005-1.png){#fig-figures0005 fig-align='center' width=768}\n:::\n:::\n\n\n\nAn usual problem when dealing with multivariate data is that, in the absence of greater context, there is no singular approach to determining a ranking of observations. This is also true of functional data, hence there is no specific way to determine functional quantiles, nor a universal definition of a functional outlier. @pintado:2009 defines a form of functional depth, which allows for the computation of the functional median (as well as other quantiles), a work which was latter expanded in @sun:2011, wherein the procedure to construct a functional boxplot was delineated, allowing also for outlier detection. The computational implementation of functional boxplots is available in the '<tt>fda</tt>' package for the <tt>R</tt> programming language, as part of the method <tt>fbplot()</tt>. Moreover, the computation of the functional depth developed in @pintado:2009 is available in the <tt>tf</tt> package through the <tt>tf_depth()</tt> method. @fig-figures0006 displays functional boxplots of the absorbance curves, as well as their corresponding derivatives. Interesting insights may be gleaned with respect to manner in which functional depth detects outliers: in the first boxplot the observations $43$, $44$, $99$, $140$ and $185$ are classified as outliers, whilst for the second boxplot, only the observation $140$ is classified as an outlier. This is a sensible result, as it may be observed that the outlier observations in the former plot present significant vertical shift with respect to the median curves, and the first order derivative of a function is invariant with respect to any constant term (i.e., any constant vertical shift), hence the application of the derivative '<it>standardizes</it>' the absorbance curves. @fig-figures0007 enhances previous plots seen in @fig-figures0002 and @fig-figures0004 by highlighting outlier curves. As previously stated, the outlier curves for the absorbance curves possess significant vertical shift 'upwards', i.e., they are consistently greater than the mass of functional data, but also present a similar overall 'shape'. By contrast, the sole outlier for the derivative of the absorbance curves presents more complex behaviour, initially being greater than the mass of functional data, and crossing over so that it is lesser. We note, from Figure @fig-figures0008, that the functional mean and median are very similar in the case of the derivative of the absorbance curves, whilst for the absorbance curves themselves there is indication of positive skewness, particularly for curves whose corresponding meat sample has more than 20% of fat.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Upper panel: functional boxplots of the absorbance curves. Lower panel: functional boxplots of the derivative of the absorbance curves.](vignette0001_files/figure-html/fig-figures0006-1.png){#fig-figures0006 fig-align='center' width=768}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Upper panel: spaghetti plot of the absorbance curves, separated by fat percentage, with outlier curves highlighted in black; observation $140$ is likewise dashed. Lower panel: spaghetti plot of the derivative of the absorbance curves, separated by fat percentage, with outlier curves highlighted in black.](vignette0001_files/figure-html/fig-figures0007-1.png){#fig-figures0007 fig-align='center' width=768}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Upper panel: mean and median absorbance curves, separated by fat percentage, represented respectively by solid and dashed curves. Lower panel: mean and median derivative of the absorbance curves, separated by fat percentage, represented respectively by solid and dashed curves.](vignette0001_files/figure-html/fig-figures0008-1.png){#fig-figures0008 fig-align='center' width=768}\n:::\n:::\n\n\n\nNote that @fig-figures0002, @fig-figures0003 and @fig-figures0004 display the <it>raw</it> absorbance curves (and corresponding derivatives), that is, we employ no smoothing techniques in those displays. This is feasible for this particular data set due to the fact that the absorbance curves (and corresponding derivatives) are contaminated by very little noise. The method <tt>tfb()</tt>, of the '<tt>tidyfun</tt>' allows us to represent variables originally stored as <tt>tfd</tt> objects, ideal for raw functional data, to variables stored as <tt>tfb</tt> functional data, which is ideal for representing functional data as a linear combination of a finite number of basis functions; this is done by an interface with methods on the '<tt>mgcv</tt>' <tt>R</tt> package. In particular, we will smooth the usual absorbance curves utilizing $K = 15$ B-spline basis, whilst the derivatives of the absorbance curves will be smoothed utilizing $K = 30$ B-spline basis. The results are presented in Figures @fig-figures0009 and @fig-figures0010. Whilst certain distinctions are visible between the raw and smoothed data, it is apparent that the smoothed data provides a reasonable approximation to the sampled curves. Moreover, we note that the <tt>tfb()</tt> method itself provides a diagnostic with respect to the amount of variability preserved in the basis representation (which is ommited in the present study, but is exhibited by setting the argument <tt>verbose = TRUE</tt>): for both generated <tt>tfb</tt> objects the basis representations preserve a minimum of $99.8\\%$ variability. We may now proceed to studying the functional regression problem.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ntecator_data = tecator_data |> mutate(absorbance_basis = tfb(absorbance,\n                                                             basis = \"spline\",\n                                                             bs = \"bs\",\n                                                             k = 15,\n                                                             verbose = FALSE),\n                                      dabsorbance_basis = tfb(dabsorbance,\n                                                              basis = \"spline\",\n                                                              bs = \"bs\",\n                                                              k = 30,\n                                                              verbose = FALSE))\ng13 = tecator_data |>\n  ggplot(mapping = aes(y = absorbance_basis,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(\"Smoothed Absorbance\"),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\")) +\n  geom_vline(xintercept = 930,\n             linetype = \"dashed\",\n             col = \"black\",\n             alpha = .5)\ngrid.arrange(g03,\n             g13,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: raw absorbance curves. Right panel: smoothed absorbance curves.](vignette0001_files/figure-html/fig-figures0009-1.png){#fig-figures0009 fig-align='center' width=768}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ng14 = tecator_data |>\n  ggplot(mapping = aes(y = dabsorbance_basis,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(paste(\"Smoothed \",italic(\"D\"),\"Absorbance\")),,\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 930, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"930\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\"))\ngrid.arrange(g07,\n             g14,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: raw derivative of the absorbance curves. Right panel: smoothed derivative of the absorbance curves.](vignette0001_files/figure-html/fig-figures0010-1.png){#fig-figures0010 fig-align='center' width=768}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n# Functional Regression\n\nFor this present data set we will consider two possible models for the relationship between the mean fat percentage of sampled meats and their corresponding absorbance curves, given as follows\n\n\\begin{equation}\n  \\mu_i = \\mathbb{E}[Y_i \\vert \\chi_i] = g\\Bigg\\{\\!\\beta_0 + \\!\\!\\int^{1050}_{850} \\beta_1(s) D \\chi_i(s) \\text{d}s\\!\\Bigg\\} (\\#eq:modelI)\n\\end{equation} \\begin{equation}\n  \\mu_i =  \\mathbb{E}[Y_i \\vert \\chi_i] = g\\Bigg\\{\\!\\beta_0 + \\!\\!\\int^{1050}_{850} G(s,D \\chi_i(s)) \\text{d}s\\!\\Bigg\\} (\\#eq:modelII)\n\\end{equation}\n\nEquation \\@ref(eq:modelI) corresponds to the usual form of a Generalized Functional Linear Model (GFLM), whilst \\@ref(eq:modelII) corresponds to a more complex model, the Functional Generalized Additive Model (FGAM), as seen in @mcLean:2014. Both of these models are implemented on the '<tt>refund</tt>' <tt>R</tt> package (see @goldsmith:2024), under the <tt>pfr()</tt> and <tt>fgam()</tt> methods, respectively. This form of functional regression problem, wherein the response variable is a scalar variable and the predictors are functions, is referred to as scalar-on-function (SoF) regression. For both models to be studied presently, we will take $Y_i \\sim \\text{Beta}(\\mu_i,\\phi)$, with mean as in \\@ref(eq:modelI) or \\@ref(eq:modelII), and deviation $\\phi > 0$. In order to better diagnose the proposed models, we will split the data set into a training set, composed of $N_\\text{train} = 108$ observations, and a test data set, composed of $N_\\text{test} = 107$ observations.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\nset.seed(747)\nN = nrow(tecator_data)\nprop_train = .5\ntecator_data = tecator_data |> \n  mutate(train = sample(x = rep(x = c(1, 0),\n                                times = c(ceiling(N * prop_train),\n                                          N - ceiling(N * prop_train)))))\ng15 = tecator_data |>\n  subset(train == 1) |>\n  ggplot(mapping = aes(y = absorbance_basis,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(\"Smoothed Absorbance\"),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\"))\ng16 = tecator_data |>\n  subset(train == 0) |>\n  ggplot(mapping = aes(y = absorbance_basis,\n                       color = fat20)) +\n  geom_spaghetti() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = expression(paste(\"Wavelength \", \"(in \", italic(\"nm\"), \")\")),\n       y = substitute(\"Smoothed Absorbance\"),\n       col = \"\") +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(850, 900, 950, 1000, 1050),\n                     labels = c(\"850\", \"900\", \"950\", \"1000\", \"1050\"),\n                     limits = c(845, 1055)) +\n  scale_color_manual(values = c(\"green\", \"orange\"))\ngrid.arrange(g15,\n             g16,\n             ncol = 2)\n```\n\n::: {.cell-output-display}\n![Left panel: smoothed absorbance curves on the training set. Right panel: smoothed absorbance curves on the test set.](vignette0001_files/figure-html/fig-figures0011-1.png){#fig-figures0011 fig-align='center' width=768}\n:::\n:::\n\n\n\n## Model I\n\nNoticing.\n\n## Model II\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\ntecator_data$dabsorbance_matrix = tecator_data$dabsorbance |> as.matrix()\ntecator_data = tecator_data |> mutate(fat = fat / 100)\nfit = fgam(formula = fat ~ af(X = dabsorbance_matrix,\n                               bs = \"tp\",\n                               k = 5,\n                               m = 3),\n           fitter = \"gam\",\n           family = betar(link = \"logit\"),\n           tensortype = \"te\",\n           data = tecator_data,\n           weights = tecator_data$train,\n           method = \"REML\",\n           scale = 0.06361)\n\ntecator_data = tecator_data |>\n  mutate(fat_fitted = fit$fitted.values)\n\ng17 = tecator_data |>\n  mutate(train = factor(x = ifelse(test = tecator_data$train == 1, \"Train\", \"Test\"),\n                        levels = c(\"Train\", \"Test\"))) |>\n  ggplot(mapping = aes(x = fat_fitted,\n                       y = fat,\n                       color = train)) +\n  geom_point() +\n  theme_classic() +\n  theme(text = element_text(size = unit(11, \"pt\"),\n                            family = \"LM Roman 10\",\n                            color = \"black\"),\n        axis.line = element_line(arrow = grid::arrow(length = unit(0.08, \"cm\"), \n                                                     ends = \"last\",\n                                                     angle = 30,\n                                                     type = \"closed\"),\n                                 linewidth = .25),\n        axis.ticks = element_line(color = \"black\",\n                                  linewidth = .125),\n        legend.position = \"top\") +\n  labs(x = \"Fitted\",\n       y = \"True\",\n       col = \"\") +\n  scale_color_manual(values = c(\"blue\", \"red\")) +\n  scale_x_continuous(expand = c(0, 0),\n                     breaks = c(0, .5, 1),\n                     labels = c(\"0\", \"1/2\", \"1\"),\n                     limits = c(0, 1)) +\n  scale_y_continuous(expand = c(0, 0),\n                     breaks = c(0, .5, 1),\n                     labels = c(\"0\", \"1/2\", \"1\"),\n                     limits = c(0, 1)) +\n  geom_abline(slope = 1,\n              intercept = 0,\n              linetype = \"dashed\")\n  \ng17\n```\n\n::: {.cell-output-display}\n![](vignette0001_files/figure-html/estimation0002-1.png){fig-align='center' width=384}\n:::\n:::\n\n\n\nResiduals\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .funky .cell-code}\nlibrary(\"gamlss\")\n#> Carregando pacotes exigidos: gamlss.data\n#> \n#> Anexando pacote: 'gamlss.data'\n#> O seguinte objeto é mascarado por 'package:datasets':\n#> \n#>     sleep\n#> Carregando pacotes exigidos: gamlss.dist\n#> Carregando pacotes exigidos: parallel\n#>  **********   GAMLSS Version 5.4-22  **********\n#> For more on GAMLSS look at https://www.gamlss.com/\n#> Type gamlssNews() to see new features/changes/bug fixes.\n#> \n#> Anexando pacote: 'gamlss'\n#> O seguinte objeto é mascarado por 'package:refund':\n#> \n#>     re\n#> O seguinte objeto é mascarado por 'package:mgcv':\n#> \n#>     lp\ncrack = data.frame(ww = tecator_data$fat[ tecator_data$train == 1 ],\n                   zz = fit$fitted.values[ tecator_data$train == 1 ])\n\nreg = gamlss(formula = ww ~ zz,\n             family = BE(mu.link = \"identity\",\n                         sigma.link = \"identity\"),\n             data = crack)\n#> GAMLSS-RS iteration 1: Global Deviance = -257.1634 \n#> GAMLSS-RS iteration 2: Global Deviance = -452.3448 \n#> GAMLSS-RS iteration 3: Global Deviance = -535.9769 \n#> GAMLSS-RS iteration 4: Global Deviance = -537.3277 \n#> GAMLSS-RS iteration 5: Global Deviance = -537.3282\nplot(reg)\n```\n\n::: {.cell-output-display}\n![](vignette0001_files/figure-html/estimation0003-1.png){fig-align='center' width=672}\n:::\n\n```\n#> ******************************************************************\n#> \t      Summary of the Quantile Residuals\n#>                            mean   =  0.0306589 \n#>                        variance   =  1.008963 \n#>                coef. of skewness  =  -0.4881235 \n#>                coef. of kurtosis  =  3.368245 \n#> Filliben correlation coefficient  =  0.9901213 \n#> ******************************************************************\n\nfit_total = fgam(formula = fat ~ af(X = dabsorbance_matrix,\n                                    bs = \"tp\",\n                                    k = 5,\n                                    m = 3),\n                 fitter = \"gam\",\n                 family = betar(link = \"logit\"),\n                 tensortype = \"te\",\n                 data = tecator_data,\n                 method = \"REML\",\n                 scale = 0.112152)\n\nplot(x = fit_total$fitted.values,\n     y = tecator_data$fat)\n```\n\n::: {.cell-output-display}\n![](vignette0001_files/figure-html/estimation0003-2.png){fig-align='center' width=672}\n:::\n\n```{.r .funky .cell-code}\n\nheroina = data.frame(ww = tecator_data$fat,\n                     zz = fit_total$fitted.values)\n\nreg = gamlss(formula = ww ~ zz,\n             family = BE(mu.link = \"identity\",\n                         sigma.link = \"identity\"),\n             data = heroina)\n#> GAMLSS-RS iteration 1: Global Deviance = -511.795 \n#> GAMLSS-RS iteration 2: Global Deviance = -888.5879 \n#> GAMLSS-RS iteration 3: Global Deviance = -1045.234 \n#> GAMLSS-RS iteration 4: Global Deviance = -1047.916 \n#> GAMLSS-RS iteration 5: Global Deviance = -1047.917 \n#> GAMLSS-RS iteration 6: Global Deviance = -1047.917\nplot(reg)\n```\n\n::: {.cell-output-display}\n![](vignette0001_files/figure-html/estimation0003-3.png){fig-align='center' width=672}\n:::\n\n```\n#> ******************************************************************\n#> \t      Summary of the Quantile Residuals\n#>                            mean   =  0.04270085 \n#>                        variance   =  1.004243 \n#>                coef. of skewness  =  -0.7922292 \n#>                coef. of kurtosis  =  4.073507 \n#> Filliben correlation coefficient  =  0.9811175 \n#> ******************************************************************\n```\n:::\n\n\n\nNoticing\n\n# Concluding Remarks\n\nNoticing.\n\n------------------------------------------------------------------------\n\n> \"The test is over.\"<br>['Fight Test', The Flaming Lips (2002)](https://open.spotify.com/intl-pt/track/0ScgmigVOJr2mFsAtwFQmz?si=2f2e6b403e934f04)\n\n# References\n",
    "supporting": [
      "vignette0001_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}